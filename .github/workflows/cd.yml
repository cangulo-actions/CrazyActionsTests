name: ðŸš€ CD
on:
  push:
    branches:
      - main

jobs:
  semver:
    name: release new version
    runs-on: ubuntu-latest
    steps:
      - name: checkout
        uses: actions/checkout@v4
        with:
          token: ${{ secrets.GH_AUTOMATION_TOKEN }} 

      - name: semver
        # this must target main or a valid branch in the cangulo-actions/semver repo
        uses: cangulo-actions/semver@#44
        id: semver
        with:
          create-gh-release: true
          print-summary: true
          # configuration: semver-config.json
      - name: add semver output to GH summary
        uses: actions/github-script@v7
        env:
          SEMVER_OUTPUTS: ${{ toJson(steps.semver.outputs) }}
        with:
          script: |
            const semverOutputs = JSON.parse(process.env.SEMVER_OUTPUTS)

            console.log('semverOutputs', semverOutputs)

            core.summary
              .addHeading('Semver Output:')
              .addCodeBlock(JSON.stringify(semverOutputs, null, 2), 'json')
              .write()      

# refresh 2023-11-27